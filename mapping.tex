Separating dynamics, tracer and physics grids introduces the added complexity of having to map the state from dynamics and tracer grids to the physics grid; and mapping physics tracer tendencies back to the tracer grid and physics tendencies needed by the dynamical core to the dynamics grid. The dynamics grid refers to the Gauss-Lobatto-Legendre (GLL) quadrature nodes by the spectral-element method to solve the momentum equations for the momentum vector $(u,v)$, thermodynamics equation for temperature ($T$), continuity equation for dry air ($M$), and continuity equations for water vapor and condensates thermodynamically active \citep[see, e.g., ][ for details]{LetAl2018JAMES}. By tracer grid we refer to the $pg3$ grid on which CSLAM performs tracer transport of water vapor, condensates and other tracers. The GLL value for water vapor and condensates is overwritten by the CSLAM values every physics time-step so that the spectral-element advection of water species does not become decoupled from the the CSLAM advection of the same water species. Mapping velocity components, dry air mass and temperature from the GLL grid to the $pg2$ grid is done by using the internal degree 3 Lagrange basis functions in CAM-SE \citep[ as described in  ][ for pg3; exactly the same methods can be used for $pg2$]{HL2018MWR}.

As compared to the $pg3$ configuration, the extra complication of the $pg2$ setup is that tracer state needs to be mapped from the tracer grid to the physics grid and tracer tendencies need to the mapped from the physics grid to CSLAM grid. In order to describe the algorithm some notation needs to be introduced.

The mapping algorithm is applied to each element $\Omega$ (with spherical area $\Delta \Omega$) so without loss of generality consider one element. Let $\Delta A^{(pg)}_k$ and $\Delta A^{(nc)}_\ell$ be the spherical area of the physics grid grid cell $A^{(pg)}_k$ and CSLAM control volume $A^{(nc)}_\ell$, respectively. The physics grid cells and CSLAM cells respectively span the element without gaps or overlaps
\begin{eqnarray}
\cup_{k=1}^{pg^2}A^{(pg)}_k=\Omega \text{ and } A^{(pg)}_k \cap A^{(pg)}_\ell = \emptyset \quad \forall k\ne \ell,\\
\cup_{k=1}^{nc^2}A^{(nc)}_k=\Omega \text{ and } A^{(nc)}_k \cap A^{(nc)}_\ell = \emptyset \quad \forall k\ne \ell.
\end{eqnarray}
The overlap areas between the $k$-th physics grid cell and CSLAM cells is denoted
\begin{equation}
A_{k\ell}=A^{(pg)}_k \cap A^{(nc)}_\ell,
\end{equation}
so that
\begin{equation}
A^{(pg)}_k=\cup_{l=1}^{nc^2}A_{k\ell}.
\end{equation}
This overlap grid is also referred to as an exhange grid.
\subsection{Mapping tracers from CSLAM to $pg$}
For mapping tracer state from the CSLAM grid to any physics grid can be done using exising CSLAM technology, i.e. do a high-order shape-preserving reconstruction of mixing ratio and dry air mass inside each CSLAM control volume and integrate those reconstruction functions over the overlap areas \citep{LNU2010JCP,NL2010JCP}. This algorithm retains the properties of CSLAM: inherent mass-conservation, mixing ratio shape-preservation and linear-correlation preservation. 

In mathemtical terms the remapping is given by
\begin{eqnarray}
\Delta M^{(pg)}_{\ell}\Delta A_{\ell} &=\sum_{k=1}^{nc^2}\overline{\Delta M}^{(nc)}_{k\ell} \Delta A_{k\ell},\\
m^{(pg)}_{\ell}\Delta A_{\ell}&=\frac{1}{\Delta M^{(pg)}_{\ell}}\sum_{k=1}^{nc^2}\overline{\Delta M\, m}^{(nc)}_{k\ell} \Delta A_{k\ell},
\end{eqnarray}
where 
\begin{equation}
\frac{1}{\Delta A_{k\ell}}\int_{A_{k\ell}}(\Delta M m)^{(nc)}(x,y)dA.
\end{equation}


The tendencies from the parameterizations are computed on the physics grid. The tracer tendency in physics grid cell $k$ is denoted $f_k^{(pg)}$. The problem is how to map $f_k^{(pg)}$ to the CSLAM control volumes $f^{(nc)}$ satisfying the following constraints:
\begin{enumerate}
\item {\bf{Local mass-conservation}}
\begin{equation}
f_k^{(pg)}\Delta p^{(pg)}_k=\cup_{\ell=1}^{nc^2}\Delta A_{k\ell}\Delta p^{(nc)}_\ell f^{(nc)}_\ell,
\end{equation}
where $\Delta p^{(pg)}_k$ is the pressure level thickness in physics grid cell $k$ and similarly for $\Delta p^{(nc)}$.
\item {\bf{Shape-preservation in mixing ratio}}: The forcing on the CSLAM grid should not produce a value smaller than the new physics grid mixing ratio, $m^{(pg)}_k+\Delta tf_k^{(pg)}$ or a value smaller than the existing CSLAM mixing ratios over the overlap areas $m^{(nc)}_{k\ell}$
\begin{equation}
m_k^{(min)}=\min \left( m^{(pg)}_k+\Delta t f_k^{(pg)},\left\{ m^{(nc)}_{k\ell} |\ell=1,nc^2\right\} \right),
\end{equation}
where $\Delta t$ is the physics time-step. Similarly for maxima
\begin{equation}
m_k^{(max)}=\max \left( m^{(pg)}_k+\Delta t f_k^{(pg)},\left\{ m^{(nc)}_{k\ell} |\ell=1,nc^2\right\} \right),
\end{equation}
\item {\bf{Linear correlation preservation}}: The physics forcing must not disrupt linear tracer correlation between species on the CSLAM grid \citep[see, e.g., ][]{LT2011QJR}.
\item {\bf{Consistency}}: A constant mixing ratio tendency, $cnst$, on the physics grid, $f_k^{(pg)}=cnst$ $\forall k$, must result in the same (constant) forcing on the CSLAM grid, $f_\ell^{(nc)}=f_k^{(pg)}=cnst$ $\forall \ell$.
\end{enumerate}
To motivate the algorithm that will simultaneously satisfy 1-4 it is informative to discuss how `standard' mapping algorithms will violate one or more of the constraints.
\begin{itemize}
\item Conservative remapping: 
\item Interpolation:
\end{itemize}

{\color{red}{some text about how challenging it is to satisfy 1-3 simultaneously}}\\
\subsection{Algorithm}

